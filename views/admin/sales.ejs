<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Wear - Sales Report</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="/adminStyle/sales.css">
</head>
<body>
    <!-- Debug toggle button -->
    <button class="debug-toggle" onclick="toggleDebug()">Toggle Debug Info</button>
    
    <!-- Debug info panel -->
    <div class="debug-info" id="debugInfo">
        <h5>Debug Information:</h5>
        <p>totalSales: <%= typeof totalSales !== 'undefined' ? totalSales : 'undefined' %></p>
        <p>totalItems: <%= typeof totalItems !== 'undefined' ? totalItems : 'undefined' %></p>
        <p>totalDiscounts: <%= typeof totalDiscounts !== 'undefined' ? totalDiscounts : 'undefined' %></p>
        <p>totalProductDiscounts: <%= typeof totalProductDiscounts !== 'undefined' ? totalProductDiscounts : 'undefined' %></p>
        <p>totalCouponDiscounts: <%= typeof totalCouponDiscounts !== 'undefined' ? totalCouponDiscounts : 'undefined' %></p>
        <p>uniqueCustomers: <%= typeof uniqueCustomers !== 'undefined' ? uniqueCustomers : 'undefined' %></p>
        <p>ordersWithCoupons: <%= typeof ordersWithCoupons !== 'undefined' ? ordersWithCoupons : 'undefined' %></p>
        <p>couponUsageCount: <%= typeof couponUsageCount !== 'undefined' ? couponUsageCount : 'undefined' %></p>
        <p>salesData length: <%= salesData ? salesData.length : 'undefined' %></p>
        <% if (salesData && salesData.length > 0) { %>
            <p>First sale item:</p>
            <pre><%= JSON.stringify(salesData[0], null, 2) %></pre>
        <% } %>
    </div>

    <div class="admin-layout">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-shopping-bag"></i>
                    <span>ELITE WEAR</span>
                </div>
            </div>
            <ul class="sidebar-menu">
                <li>
                    <a href="/admin/">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/productManagement">
                        <i class="fas fa-box"></i>
                        <span>Products</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/adminorder">
                        <i class="fas fa-list"></i>
                        <span>Order List</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/customers">
                        <i class="fas fa-users"></i>
                        <span>Customers</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/sales" class="active">
                        <i class="fas fa-chart-line"></i>
                        <span>Sales</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/categories">
                        <i class="fas fa-tag"></i>
                        <span>Category</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/coupons">
                        <i class="fas fa-percent"></i>
                        <span>Coupons</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/getbannerPage">
                        <i class="fas fa-image"></i>
                        <span>Banner</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/wallet-transactions">
                        <i class="fas fa-wallet"></i>
                        <span>Wallet</span>
                    </a>
                </li>
                <li>
                    <a href="/admin/reviews">
                        <i class="fas fa-star"></i>
                        <span>Review Management</span>
                    </a>
                </li>
            </ul>
            <div class="sidebar-footer">
                <button class="btn btn-outline-primary">Account</button>
                <a href="/admin/logout" class="btn btn-logout">Logout</a>
            </div>
        </div>
        
        <!-- Sidebar Toggle Button -->
        <button id="sidebar-toggle">
            <i class="fas fa-chevron-left"></i>
        </button>
        
        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Sales Report</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/admin/dashboard">Dashboard</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Sales Report</li>
                        </ol>
                    </nav>
                </div>
                <div class="user-profile">
                    <div class="user-info">
                        <p class="user-name"><%= user?.fullname || 'Admin' %></p>
                        <p class="user-role">Administrator</p>
                    </div>
                    <img src="/api/placeholder/40/40?query=profile" alt="User Profile" class="user-avatar">
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon sales">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3>₹<%= (typeof totalSales !== 'undefined' ? totalSales : 0).toLocaleString() %></h3>
                        <p>Total Sales</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>12.5% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon items">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div class="stat-info">
                        <h3><%= typeof totalItems !== 'undefined' ? totalItems : 0 %></h3>
                        <p>Items Sold</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>8.2% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon customers">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3><%= typeof uniqueCustomers !== 'undefined' ? uniqueCustomers : 0 %></h3>
                        <p>Unique Customers</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>5.3% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orders">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-info">
                        <h3><%= salesData ? salesData.length : 0 %></h3>
                        <p>Total Orders</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>7.1% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon coupons">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <div class="stat-info">
                        <h3>₹<%= (typeof totalCouponDiscounts !== 'undefined' ? totalCouponDiscounts : 0).toLocaleString() %></h3>
                        <p>Coupon Discounts</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>4.2% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon discounts" style="background-color: #8e44ad;">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-info">
                        <h3>₹<%= (typeof totalProductDiscounts !== 'undefined' ? totalProductDiscounts : 0).toLocaleString() %></h3>
                        <p>Product Offers</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>5.2% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon coupons" style="background-color: #2ecc71;">
                        <i class="fas fa-tags"></i>
                    </div>
                    <div class="stat-info">
                        <h3><%= typeof ordersWithCoupons !== 'undefined' ? ordersWithCoupons : 0 %></h3>
                        <p>Orders with Coupons</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>6.8% vs last period</span>
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon coupons" style="background-color: #3498db;">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <div class="stat-info">
                        <h3><%= typeof couponUsageCount !== 'undefined' ? couponUsageCount : 0 %></h3>
                        <p>Unique Coupons Used</p>
                        <div class="stat-trend trend-up">
                            <i class="fas fa-arrow-up trend-icon"></i>
                            <span>3.5% vs last period</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <form id="filterForm" action="/admin/sales" method="GET">
                <div class="filter-section">
                    <div class="date-filter">
                        <span>Date Range:</span>
                        <input type="text" id="dateRange" name="dateRange" class="border-0 bg-transparent" placeholder="Select date range">
                        <input type="hidden" name="from" id="fromDate" value="<%= fromDate %>">
                        <input type="hidden" name="to" id="toDate" value="<%= toDate %>">
                    </div>
                    <div class="discount-filter">
                        <span>Discount:</span>
                        <select id="discountFilter" name="discountFilter" class="form-select form-select-sm">
                            <option value="" <%= discountFilter === '' ? 'selected' : '' %>>All</option>
                            <option value="with-discount" <%= discountFilter === 'with-discount' ? 'selected' : '' %>>With Any Discount</option>
                            <option value="no-discount" <%= discountFilter === 'no-discount' ? 'selected' : '' %>>No Discount</option>
                            <option value="coupon-only" <%= discountFilter === 'coupon-only' ? 'selected' : '' %>>Coupon Only</option>
                            <option value="product-offer-only" <%= discountFilter === 'product-offer-only' ? 'selected' : '' %>>Product Offer Only</option>
                        </select>
                    </div>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" name="search" value="<%= searchQuery %>" placeholder="Search by buyer, product, coupon, or order ID...">
                    </div>
                </div>
                
                <!-- Quick filters -->
                <div class="quick-filters">
                    <div class="btn-group">
                        <button type="button" class="btn quick-filter" data-filter="today">Today</button>
                        <button type="button" class="btn quick-filter" data-filter="yesterday">Yesterday</button>
                        <button type="button" class="btn quick-filter" data-filter="week">Last 7 Days</button>
                        <button type="button" class="btn quick-filter" data-filter="month">Last 30 Days</button>
                        <button type="button" class="btn quick-filter" data-filter="year">Last Year</button>
                    </div>
                </div>
            </form>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Sales Transactions</h3>
                    <div>
                        <button id="downloadPDF" class="btn btn-sm btn-download">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button id="downloadExcel" class="btn btn-sm btn-excel ms-2">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th data-sort="orderNumber">Order # <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="buyer">Buyer <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="productName">Product Name <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="quantity">Qty <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="price">Price <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="couponCode">Coupon <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="productOffer">Product Offer <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="category">Category <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                                <th data-sort="total">Total <i class="fas fa-sort ms-1 text-gray-400"></i></th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (salesData && salesData.length > 0) { %>
                                <% salesData.forEach(item => { %>
                                    <tr>
                                        <td><%= item.orderNumber || '' %></td>
                                        <td><%= item.buyer || 'Unknown' %></td>
                                        <td><%= item.productName || 'Unknown Product' %></td>
                                        <td><%= item.quantity || 0 %></td>
                                        <td>₹<%= (item.price || 0).toLocaleString() %></td>
                                        <td>
                                            <% if (item.couponApplied) { %>
                                                <span class="coupon-badge" title="<%= item.couponDescription || '' %>">
                                                    <%= item.couponCode || 'Coupon' %> (<%= item.couponPercent || 0 %>%)
                                                </span>
                                            <% } else { %>
                                                <span class="coupon-badge no-coupon">-</span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <% if (item.productEffectiveDiscount && item.productEffectiveDiscount > 0) { %>
                                                <span class="product-offer-badge">
                                                    <%= item.productEffectiveDiscount %>%
                                                </span>
                                            <% } else { %>
                                                <span class="product-offer-badge no-offer">-</span>
                                            <% } %>
                                        </td>
                                        <td><span class="category-badge"><%= item.category || 'Uncategorized' %></span></td>
                                        <td>₹<%= (item.total || 0).toLocaleString() %></td>
                                    </tr>
                                <% }); %>
                            <% } else { %>
                                <tr>
                                    <td colspan="9" class="text-center py-5">
                                        <div class="empty-state">
                                            <i class="fas fa-chart-bar mb-3 text-gray-300"></i>
                                            <p class="text-gray-500 mb-3">No sales data found for the selected period</p>
                                            <button type="button" class="btn btn-primary" onclick="resetFilters()">
                                                <i class="fas fa-sync-alt me-2"></i> Reset Filters
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination Controls -->
            <% if (totalPages > 1) { %>
                <nav aria-label="Sales report pagination">
                    <ul class="pagination justify-content-center">
                        <!-- Previous Button -->
                        <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
                            <a class="page-link" href="?page=<%= currentPage - 1 %>&from=<%= fromDate %>&to=<%= toDate %>&search=<%= encodeURIComponent(searchQuery) %>&discountFilter=<%= discountFilter %>" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <!-- Page Numbers -->
                        <% for(let i = 1; i <= totalPages; i++) { %>
                            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                <a class="page-link" href="?page=<%= i %>&from=<%= fromDate %>&to=<%= toDate %>&search=<%= encodeURIComponent(searchQuery) %>&discountFilter=<%= discountFilter %>"><%= i %></a>
                            </li>
                        <% } %>
                        <!-- Next Button -->
                        <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                            <a class="page-link" href="?page=<%= currentPage + 1 %>&from=<%= fromDate %>&to=<%= toDate %>&search=<%= encodeURIComponent(searchQuery) %>&discountFilter=<%= discountFilter %>" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            <% } %>

            <div class="footer">
                <div>
                    <a href="/admin/dashboard" class="btn btn-account">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                    <a href="/admin/logout" class="btn btn-logout">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize date range picker
            const fromDate = document.getElementById('fromDate').value;
            const toDate = document.getElementById('toDate').value;
            
            flatpickr("#dateRange", {
                mode: "range",
                dateFormat: "Y-m-d",
                defaultDate: [fromDate, toDate],
                onChange: function(selectedDates, dateStr, instance) {
                    if (selectedDates.length === 2) {
                        document.getElementById('fromDate').value = formatDate(selectedDates[0]);
                        document.getElementById('toDate').value = formatDate(selectedDates[1]);
                        document.getElementById('filterForm').submit();
                    }
                }
            });
            
            function formatDate(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
            
            // Search functionality with debounce
            const searchInput = document.querySelector('input[name="search"]');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    document.getElementById('filterForm').submit();
                }, 500);
            });
            
            // Discount filter change
            document.getElementById('discountFilter').addEventListener('change', function() {
                document.getElementById('filterForm').submit();
            });
            
            // Quick date filters
            const quickFilters = document.querySelectorAll('.quick-filter');
            quickFilters.forEach(filter => {
                filter.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all filters
                    quickFilters.forEach(f => f.classList.remove('active'));
                    // Add active class to clicked filter
                    this.classList.add('active');
                    
                    const filterType = this.dataset.filter;
                    const today = new Date();
                    let fromDate = new Date();
                    
                    switch(filterType) {
                        case 'today':
                            // Today's date
                            break;
                        case 'yesterday':
                            fromDate.setDate(today.getDate() - 1);
                            break;
                        case 'week':
                            fromDate.setDate(today.getDate() - 7);
                            break;
                        case 'month':
                            fromDate.setMonth(today.getMonth() - 1);
                            break;
                        case 'year':
                            fromDate.setFullYear(today.getFullYear() - 1);
                            break;
                    }
                    
                    document.getElementById('fromDate').value = formatDate(fromDate);
                    document.getElementById('toDate').value = formatDate(today);
                    
                    document.getElementById('filterForm').submit();
                });
            });

            // PDF Download
            document.getElementById('downloadPDF').addEventListener('click', function() {
                const fromDate = document.getElementById('fromDate').value;
                const toDate = document.getElementById('toDate').value;
                const search = searchInput.value;
                const discountFilter = document.getElementById('discountFilter').value;
                
                window.location.href = `/admin/sales/download-pdf?from=${fromDate}&to=${toDate}&search=${encodeURIComponent(search)}&discountFilter=${discountFilter}`;
            });
            
            // Excel Download
            document.getElementById('downloadExcel').addEventListener('click', function() {
                const fromDate = document.getElementById('fromDate').value;
                const toDate = document.getElementById('toDate').value;
                const search = searchInput.value;
                const discountFilter = document.getElementById('discountFilter').value;
                
                window.location.href = `/admin/sales/download-excel?from=${fromDate}&to=${toDate}&search=${encodeURIComponent(search)}&discountFilter=${discountFilter}`;
            });
            
            // Table sorting
            const tableHeaders = document.querySelectorAll('th[data-sort]');
            tableHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const sortField = this.dataset.sort;
                    const currentOrder = this.dataset.order || 'asc';
                    const newOrder = currentOrder === 'asc' ? 'desc' : 'asc';
                    
                    // Update UI to show sort direction
                    tableHeaders.forEach(h => {
                        h.dataset.order = '';
                        const icon = h.querySelector('i');
                        if (icon) {
                            icon.className = 'fas fa-sort ms-1 text-gray-400';
                        }
                    });
                    
                    this.dataset.order = newOrder;
                    
                    // Update sort icon
                    const icon = this.querySelector('i');
                    if (icon) {
                        icon.className = `fas fa-sort-${newOrder === 'asc' ? 'up' : 'down'} ms-1 text-primary`;
                    }
                    
                    // Sort the table
                    sortTable(sortField, newOrder);
                });
            });
            
            function sortTable(field, order) {
                const tbody = document.querySelector('table tbody');
                const rows = Array.from(tbody.querySelectorAll('tr'));
                
                // Get column index
                const headerRow = document.querySelector('table thead tr');
                const headers = Array.from(headerRow.querySelectorAll('th'));
                const columnIndex = headers.findIndex(h => h.dataset.sort === field);
                
                if (columnIndex === -1) return;
                
                // Sort rows
                rows.sort((a, b) => {
                    // Skip empty state row
                    if (a.cells.length === 1 || b.cells.length === 1) return 0;
                    
                    const aValue = a.cells[columnIndex].textContent.trim();
                    const bValue = b.cells[columnIndex].textContent.trim();
                    
                    // Handle numeric values (price, quantity, etc.)
                    if (!isNaN(aValue.replace(/[₹,]/g, '')) && !isNaN(bValue.replace(/[₹,]/g, ''))) {
                        const aNum = parseFloat(aValue.replace(/[₹,]/g, ''));
                        const bNum = parseFloat(bValue.replace(/[₹,]/g, ''));
                        return order === 'asc' ? aNum - bNum : bNum - aNum;
                    }
                    
                    // Handle percentage values
                    if (aValue.includes('%') && bValue.includes('%')) {
                        const aNum = parseFloat(aValue.replace('%', ''));
                        const bNum = parseFloat(bValue.replace('%', ''));
                        return order === 'asc' ? aNum - bNum : bNum - aNum;
                    }
                    
                    // Handle text values
                    return order === 'asc' 
                        ? aValue.localeCompare(bValue)
                        : bValue.localeCompare(aValue);
                });
                
                // Reorder rows in the DOM
                rows.forEach(row => tbody.appendChild(row));
            }
            
            // Reset filters function
            window.resetFilters = function() {
                document.getElementById('fromDate').value = '';
                document.getElementById('toDate').value = '';
                document.querySelector('input[name="search"]').value = '';
                document.getElementById('discountFilter').value = '';
                document.getElementById('filterForm').submit();
            };
            
            // Debug toggle function
            window.toggleDebug = function() {
                const debugInfo = document.getElementById('debugInfo');
                if (debugInfo.style.display === 'none' || debugInfo.style.display === '') {
                    debugInfo.style.display = 'block';
                } else {
                    debugInfo.style.display = 'none';
                }
            };
            
            // Sidebar toggle functionality
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('sidebar-collapsed');
                mainContent.classList.toggle('main-content-expanded');
                
                const icon = this.querySelector('i');
                if (icon.classList.contains('fa-chevron-left')) {
                    icon.classList.remove('fa-chevron-left');
                    icon.classList.add('fa-chevron-right');
                } else {
                    icon.classList.remove('fa-chevron-right');
                    icon.classList.add('fa-chevron-left');
                }
            });
            
            // Check screen size for responsive behavior
            function checkScreenSize() {
                if (window.innerWidth < 992) {
                    sidebar.classList.add('sidebar-collapsed');
                    mainContent.classList.add('main-content-expanded');
                    
                    const icon = sidebarToggle.querySelector('i');
                    if (icon && icon.classList.contains('fa-chevron-left')) {
                        icon.classList.remove('fa-chevron-left');
                        icon.classList.add('fa-chevron-right');
                    }
                }
            }
            
            // Run on load and resize
            checkScreenSize();
            window.addEventListener('resize', checkScreenSize);
            
            // Mobile sidebar toggle
            if (window.innerWidth < 992) {
                sidebarToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('show');
                });
            }
        });
    </script>
</body>
</html>