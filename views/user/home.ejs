<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Wear - Premium Fashion Collection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <link rel="stylesheet" href="/userStyle/home.css">
    <link rel="stylesheet" href="/userStyle/header.css">
    <link rel="stylesheet" href="/userStyle/footer.css">
</head>

<body>
    <%- include("../partials/user/header") %>

    <!-- Hero Carousel Section -->
    <section class="hero-carousel">
        <div class="swiper hero-swiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="hero-slide" style="background-image: url('/Uploads/LP-Mos_main_banner-Summer-Banner-D.jpg');">
                        <div class="hero-content">
                            <h1 class="hero-title">Summer Collection</h1>
                            <p class="hero-subtitle">Discover the perfect blend of style and comfort</p>
                            <a href="/allproduct" class="btn-shop-now">Shop Now</a>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="hero-slide" style="background-image: url('/Uploads/LP_Hero Banner_linen_D-2.jpg');">
                        <div class="hero-content">
                            <h1 class="hero-title">Premium Linen</h1>
                            <p class="hero-subtitle">Breathable fabrics for the modern gentleman</p>
                            <a href="/allproduct" class="btn-shop-now">Explore</a>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="hero-slide" style="background-image: url('/Uploads/timesnap.jpeg');">
                        <div class="hero-content">
                            <h1 class="hero-title">Formal Collection</h1>
                            <p class="hero-subtitle">Elevate your professional wardrobe</p>
                            <a href="/allproduct" class="btn-shop-now">View Collection</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
    </section>

    <% if (error) { %>
    <section class="error-section">
        <div class="container">
            <p class="error-message text-danger text-center"><%= error %></p>
        </div>
    </section>
    <% } %>

    <!-- Categories Section -->
<section class="categories-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Shop by Category</h2>
        </div>
        <div class="row g-4">
            <% 
            // Get four product images from the data array
            const categoryImages = [];
            const categoryTitles = ['Formal', 'Casual', 'Linen', 'Printed'];
            const categoryLinks = ['formal', 'casual', 'linen', 'printed'];
            
            if (data && Array.isArray(data) && data.length > 0) {
                // Get up to 4 products with images
                const productsWithImages = data.filter(p => p.images && p.images.length > 0).slice(0, 4);
                
                // Add product images to the categoryImages array
                productsWithImages.forEach(product => {
                    if (product.images && product.images.length > 0) {
                        categoryImages.push(product.images[0].url);
                    }
                });
            }
            
            // Fill with placeholders if we don't have enough product images
            while (categoryImages.length < 4) {
                categoryImages.push('/placeholder.svg?height=300&width=300&query=shirt');
            }
            
            // Render the category cards
            for (let i = 0; i < 4; i++) {
            %>
                <div class="col-6 col-md-3">
                    <a href="/allproduct?category=<%= categoryLinks[i] %>" class="category-card">
                        <div class="category-image">
                            <img src="<%= categoryImages[i] %>" alt="<%= categoryTitles[i] %> Shirts" class="product-image">
                        </div>
                        <h3 class="category-title"><%= categoryTitles[i] %></h3>
                    </a>
                </div>
            <% } %>
        </div>
    </div>
</section>

    <!-- New Arrivals Section -->
    <section class="new-arrivals-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">New Arrivals</h2>
                <a href="/allproduct" class="view-all">View All <i class="fas fa-arrow-right"></i></a>
            </div>
            
            <div class="swiper products-swiper">
                <div class="swiper-wrapper">
                    <% if (data && Array.isArray(data) && data.length > 0) { %>
                        <% data.forEach((product) => { %>
                            <div class="swiper-slide">
                                <div class="product-card">
                                    <div class="wishlist-icon">
                                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="wishlist-heart" data-product-id="<%= product._id %>">
                                            <path class="heart" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                        </svg>
                                    </div>
                                    <a href="/productdetails/<%= product._id %>" class="product-image-link">
                                        <img src="<%= product.images && product.images.length > 0 ? product.images[0].url : '/api/placeholder/300/300' %>" alt="<%= product.name || 'Product Image' %>" class="product-image">
                                        <div class="product-overlay">
                                            <span class="quick-view">Quick View</span>
                                        </div>
                                    </a>
                                    <div class="product-info">
                                        <h3 class="product-name"><%= product.name || 'Unnamed Product' %></h3>
                                        <div class="product-price-rating">
                                            <p class="product-price">₹<%= (product.variants && product.variants.length > 0 ? product.variants[0].salePrice : 0).toFixed(2) %></p>
                                            <div class="star-rating">
                                                <% const rating = product.ratings && product.ratings.average ? product.ratings.average : 0;
                                                    for(let i = 1; i <= 5; i++) {
                                                        if(i <= rating) { %>
                                                            <i class="fas fa-star"></i>
                                                        <% } else if(i - 0.5 <= rating) { %>
                                                            <i class="fas fa-star-half-alt"></i>
                                                        <% } else { %>
                                                            <i class="far fa-star"></i>
                                                        <% } 
                                                    } 
                                                %>
                                            </div>
                                        </div>
                                        <a href="/productdetails/<%= product._id %>" class="btn-view-product">View Product</a>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    <% } else { %>
                        <div class="swiper-slide">
                            <p class="no-products">No new arrivals available at this time.</p>
                        </div>
                    <% } %>
                </div>
                <div class="swiper-pagination"></div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </div>
    </section>

    <!-- Featured Banner -->
    <section class="featured-banner">
        <div class="container">
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="banner-card" style="background-image: url('/Uploads/LP_Hero Banner_linen_D-2.jpg');">
                        <div class="banner-content">
                            <h3>Summer Essentials</h3>
                            <p>Lightweight fabrics for hot days</p>
                            <a href="/allproduct?category=summer" class="btn-banner">Shop Now</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="banner-card" style="background-image: url('/Uploads/Screenshot 2025-04-07 201605.png');">
                        <div class="banner-content">
                            <h3>Office Collection</h3>
                            <p>Professional attire for every occasion</p>
                            <a href="/allproduct?category=formal" class="btn-banner">Explore</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Trending Products Section -->
    <section class="trending-products-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Trending Now</h2>
                <a href="/allproduct?sort=popular" class="view-all">View All <i class="fas fa-arrow-right"></i></a>
            </div>
            
            <div class="row g-4 fade-in">
                <% if (data && Array.isArray(data) && data.length > 0) { %>
                    <% data.slice(0, 4).forEach((product) => { %>
                        <div class="col-6 col-md-3">
                            <div class="product-card">
                                <div class="wishlist-icon">
                                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="wishlist-heart" data-product-id="<%= product._id %>">
                                        <path class="heart" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                    </svg>
                                </div>
                                <a href="/productdetails/<%= product._id %>" class="product-image-link">
                                    <img src="<%= product.images && product.images.length > 0 ? product.images[0].url : '/api/placeholder/300/300' %>" alt="<%= product.name || 'Product Image' %>" class="product-image">
                                    <div class="product-overlay">
                                        <span class="quick-view">Quick View</span>
                                    </div>
                                </a>
                                <div class="product-info">
                                    <h3 class="product-name"><%= product.name || 'Unnamed Product' %></h3>
                                    <div class="product-price-rating">
                                        <p class="product-price">₹<%= (product.variants && product.variants.length > 0 ? product.variants[0].salePrice : 0).toFixed(2) %></p>
                                        <div class="star-rating">
                                            <% const rating = product.ratings && product.ratings.average ? product.ratings.average : 0;
                                                for(let i = 1; i <= 5; i++) {
                                                    if(i <= rating) { %>
                                                        <i class="fas fa-star"></i>
                                                    <% } else if(i - 0.5 <= rating) { %>
                                                        <i class="fas fa-star-half-alt"></i>
                                                    <% } else { %>
                                                        <i class="far fa-star"></i>
                                                    <% } 
                                                } 
                                            %>
                                        </div>
                                    </div>
                                    <a href="/productdetails/<%= product._id %>" class="btn-view-product">View Product</a>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                <% } else { %>
                    <div class="col-12">
                        <p class="no-products">No trending products available at this time.</p>
                    </div>
                <% } %>
            </div>
        </div>
    </section>

    <!-- Collection Showcase -->
    <section class="collection-showcase">
        <div class="container">
            <div class="collection-card">
                <div class="collection-image">
                    <img src="/Uploads/Screenshot 2025-04-07 201605.png" alt="Premium Collection">
                </div>
                <div class="collection-content">
                    <h2>REFINED FORMAL SHIRTS</h2>
                    <p>Elevate your professional wardrobe with our premium formal collection. Crafted with the finest fabrics and impeccable tailoring for the modern gentleman.</p>
                    <div class="collection-features">
                        <div class="feature">
                            <i class="fas fa-tshirt"></i>
                            <span>Premium Fabrics</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-ruler"></i>
                            <span>Perfect Fit</span>
                        </div>
                        <div class="feature">
                            <i class="fas fa-medal"></i>
                            <span>Superior Quality</span>
                        </div>
                    </div>
                    <a href="/allproduct?category=formal" class="btn-collection">Explore Collection</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials-section">
        <div class="container">
            <h2 class="section-title text-center">What Our Customers Say</h2>
            
            <div class="swiper testimonials-swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <div class="testimonial-card">
                            <div class="testimonial-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <p class="testimonial-text">"The quality of shirts from Elite Wear is exceptional. The fabric feels premium and the fit is perfect. Definitely my go-to brand for formal wear."</p>
                            <div class="testimonial-author">
                                <div class="author-avatar">
                                    <img src="/placeholder.svg?height=50&width=50&query=man portrait" alt="Customer">
                                </div>
                                <div class="author-info">
                                    <h4>Rajesh Kumar</h4>
                                    <p>Verified Buyer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="testimonial-card">
                            <div class="testimonial-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <p class="testimonial-text">"I've been shopping with Elite Wear for over a year now. Their collection is always up-to-date with the latest trends, and the quality never disappoints."</p>
                            <div class="testimonial-author">
                                <div class="author-avatar">
                                    <img src="/placeholder.svg?height=50&width=50&query=young man portrait" alt="Customer">
                                </div>
                                <div class="author-info">
                                    <h4>Vikram Singh</h4>
                                    <p>Loyal Customer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="testimonial-card">
                            <div class="testimonial-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <p class="testimonial-text">"The attention to detail in Elite Wear shirts is remarkable. From the stitching to the buttons, everything speaks quality. Highly recommend their formal collection."</p>
                            <div class="testimonial-author">
                                <div class="author-avatar">
                                    <img src="/placeholder.svg?height=50&width=50&query=professional man" alt="Customer">
                                </div>
                                <div class="author-info">
                                    <h4>Arun Patel</h4>
                                    <p>Verified Buyer</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
    </section>

    <!-- Newsletter Section -->
    <section class="newsletter-section">
        <div class="container">
            <div class="newsletter-container">
                <div class="newsletter-content">
                    <h2>Subscribe to Our Newsletter</h2>
                    <p>Stay updated with our latest collections, exclusive offers, and style tips.</p>
                    <form class="newsletter-form">
                        <div class="form-group">
                            <input type="email" placeholder="Your email address" required>
                            <button type="submit">Subscribe</button>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" id="newsletter-consent" required>
                            <label for="newsletter-consent">I agree to receive marketing emails from Elite Wear</label>
                        </div>
                    </form>
                </div>
                <div class="newsletter-image">
                    <img src="/placeholder.svg?height=300&width=300&query=fashion newsletter" alt="Newsletter">
                </div>
            </div>
        </div>
    </section>

    <%- include("../partials/user/footer") %>

    <!-- Toast Container -->
    <div class="toast-container">
        <div id="wishlistToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-content">
                <i class="toast-icon"></i>
                <div class="toast-message" id="toastBody"></div>
            </div>
            <button class="toast-close" data-bs-dismiss="toast" aria-label="Close">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Quick View Modal -->
    <div class="modal fade" id="quickViewModal" tabindex="-1" aria-labelledby="quickViewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="quickViewModalLabel">Quick View</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <img id="quickViewImage" src="/placeholder.svg" alt="Product Image" class="img-fluid">
                        </div>
                        <div class="col-md-6">
                            <h3 id="quickViewName"></h3>
                            <p id="quickViewPrice" class="product-price"></p>
                            <div id="quickViewRating" class="star-rating"></div>
                            <p id="quickViewDescription"></p>
                            <a id="quickViewLink" href="#" class="btn-primary">View Details</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script>
        // Initialize Swiper carousels
        const heroSwiper = new Swiper('.hero-swiper', {
            slidesPerView: 1,
            spaceBetween: 0,
            loop: true,
            autoplay: {
                delay: 5000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.hero-swiper .swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.hero-swiper .swiper-button-next',
                prevEl: '.hero-swiper .swiper-button-prev',
            },
        });

        const productsSwiper = new Swiper('.products-swiper', {
            slidesPerView: 1,
            spaceBetween: 20,
            loop: true,
            autoplay: {
                delay: 4000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.products-swiper .swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.products-swiper .swiper-button-next',
                prevEl: '.products-swiper .swiper-button-prev',
            },
            breakpoints: {
                576: {
                    slidesPerView: 2,
                },
                768: {
                    slidesPerView: 3,
                },
                992: {
                    slidesPerView: 4,
                },
            },
        });

        const testimonialsSwiper = new Swiper('.testimonials-swiper', {
            slidesPerView: 1,
            spaceBetween: 20,
            loop: true,
            autoplay: {
                delay: 6000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.testimonials-swiper .swiper-pagination',
                clickable: true,
            },
            breakpoints: {
                768: {
                    slidesPerView: 2,
                },
                992: {
                    slidesPerView: 3,
                },
            },
        });

        // Toast functionality
        const wishlistToast = new bootstrap.Toast(document.getElementById('wishlistToast'));

        async function loadWishlistState() {
            try {
                const response = await fetch('/wishlist/ids');
                const data = await response.json();
            
                document.querySelectorAll('.wishlist-heart').forEach(heart => {
                    const productId = heart.getAttribute('data-product-id');
                    if (data.products.includes(productId)) {
                        heart.querySelector('.heart').classList.add('active');
                    }
                });
            } catch (error) {
                console.error('Error loading wishlist state:', error);
            }
        }
        loadWishlistState();

        // Handle heart click (toggle add/remove)
        document.querySelectorAll('.wishlist-heart').forEach(heart => {
            heart.addEventListener('click', async function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const productId = this.getAttribute('data-product-id');
                const heartPath = this.querySelector('.heart');
                const isActive = heartPath.classList.contains('active');
                const url = isActive ? '/wishlist/remove' : '/addTowhislist';

                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ productId: productId }),
                    });
                    
                    const data = await response.json();
                
                    const toastBody = document.getElementById('toastBody');
                    toastBody.textContent = data.message;
                    
                    const toastElement = document.getElementById('wishlistToast');
                    const toastIcon = toastElement.querySelector('.toast-icon');
                    
                    if (data.success) {
                        toastElement.classList.remove('toast-error');
                        toastElement.classList.add('toast-success');
                        toastIcon.className = 'toast-icon fas fa-check-circle';
                        heartPath.classList.toggle('active');
                    } else {
                        toastElement.classList.remove('toast-success');
                        toastElement.classList.add('toast-error');
                        toastIcon.className = 'toast-icon fas fa-exclamation-circle';
                    }
                    
                    wishlistToast.show();
                } catch (error) {
                    console.error('Error:', error);
                    const toastBody = document.getElementById('toastBody');
                    toastBody.textContent = 'Operation failed';
                    
                    const toastElement = document.getElementById('wishlistToast');
                    toastElement.classList.remove('toast-success');
                    toastElement.classList.add('toast-error');
                    toastElement.querySelector('.toast-icon').className = 'toast-icon fas fa-exclamation-circle';
                    
                    wishlistToast.show();
                }
            });
        });

        // Quick View functionality
        document.querySelectorAll('.product-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const productCard = this.closest('.product-card');
                const productLink = productCard.querySelector('.product-image-link').getAttribute('href');
                const productImage = productCard.querySelector('.product-image').getAttribute('src');
                const productName = productCard.querySelector('.product-name').textContent;
                const productPrice = productCard.querySelector('.product-price').textContent;
                const productRating = productCard.querySelector('.star-rating').innerHTML;
                
                document.getElementById('quickViewImage').setAttribute('src', productImage);
                document.getElementById('quickViewName').textContent = productName;
                document.getElementById('quickViewPrice').textContent = productPrice;
                document.getElementById('quickViewRating').innerHTML = productRating;
                document.getElementById('quickViewDescription').textContent = 'Loading product details...';
                document.getElementById('quickViewLink').setAttribute('href', productLink);
                
                const modal = new bootstrap.Modal(document.getElementById('quickViewModal'));
                modal.show();
                
                // You could fetch additional product details here if needed
                // For example: fetch(`/api/product-details/${productId}`)
            });
        });

        // Navbar scroll effect
        window.addEventListener('scroll', function () {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
        });

        // Fade-in animation
        const fadeElements = document.querySelectorAll('.fade-in');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, { threshold: 0.1 });
        fadeElements.forEach(element => observer.observe(element));
        
        // Newsletter form submission
        document.querySelector('.newsletter-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = this.querySelector('input[type="email"]').value;
            
            // Here you would typically send this to your server
            // For now, we'll just show a success message
            const toastBody = document.getElementById('toastBody');
            toastBody.textContent = 'Thank you for subscribing!';
            
            const toastElement = document.getElementById('wishlistToast');
            toastElement.classList.remove('toast-error');
            toastElement.classList.add('toast-success');
            toastElement.querySelector('.toast-icon').className = 'toast-icon fas fa-check-circle';
            
            wishlistToast.show();
            
            // Reset the form
            this.reset();
        });
    </script>
</body>

</html>
